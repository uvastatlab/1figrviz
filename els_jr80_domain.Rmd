---
title: "High-Use Journals by Domain: Elsevier"
author: "UVA StatLab/RDS"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r setup}
library(tidyverse)
library(scales)
library(readxl)
library(gridExtra)

# read in 1figr tabs
journal <- read_excel("1science/1figr_U_Virginia_edit.xlsx", sheet = 4, skip = 8)

# rename variables in journal
names(journal) <- c("sort", "journal", "issn", "provider", "type", "fig1", "jr1", "jr5", "currentper",
                    "cites", "citeper", "pubs", "pubsper", "synth", "jtier", "subtier", "dupes",
                    "oa", "oaper", "fig2", "scopus", "arif", "domain", "field", "subfield", 
                    "pub2008", "pub2009", "pub2010", "pub2011", "pub2012", "pub2013", "pub2014",
                    "pub2015", "pub2016", "pub2017", "cite2008", "cite2009", "cite2010", "cite2011",
                    "cite2012", "cite2013", "cite2014", "cite2015", "cite2016", "cite2017", 
                    "oa2008", "oa2009", "oa2010", "oa2011", "oa2012", "oa2013", "oa2014", "oa2015", 
                    "oa2016", "oa2017", "oaper2008", "oaper2009", "oaper2010", "oaper2011", "oaper2012",
                    "oaper2013", "oaper2014", "oaper2015", "oaper2016", "oaper2017", "scopus2008",
                    "scopus2009", "scopus2010", "scopus2011", "scopus2012", "scopus2013", "scopus2014",
                    "scopus2015", "scopus2016", "scopus2017", "jr12015", "jr12016", "jr12017", "jr12018",
                    "jr12015_2018", "jid", "journalname")
```

The following figures build from the prior analysis comapring the Big 5 providers, using the designation of each journal title as high-use among the provider's titles and comparing across domains within Elsevier alone.^[The "Elsevier by Domain" analysis calculated the highly-used journals within each domain separately; this analysis uses the "Big 5 Comparisons" measure of high-use, calculated across the provider as a whole.] 

## Percent of Journals Accounting for 80% of Use
Below we show the number and percent of journal titles in Elsevier that account for 80% of the downlaods in 2017 by disciplinary domain. A 20% reference line is provided for easy comparison.

```{r}
# ----------------------------------------------
# jr1 2017 downloads  
download_jr80 <- journal %>% 
  select(journal, provider, type, jr1, jr5, cites, pubs, synth, scopus, domain, field, jid) %>% 
  filter(type == "Journal") %>% 
  mutate(jr1 = as.integer(jr1)) %>% 
  arrange(provider, desc(jr1)) %>% 
  group_by(provider) %>% 
  mutate(cum_jr1 = cumsum(jr1),
         prov_jr1 = max(cum_jr1, na.rm=T),
         cum_jr1_per = (cum_jr1/prov_jr1)*100,
         jr80 = if_else(cum_jr1_per <= 80, 1, 0)) %>% 
  ungroup() 
```

```{r}
# Distribution of non-JR80 titles within Elsevier by domain
download_elsevier_jr80 <- download_jr80 %>% 
  filter(provider == "Elsevier" & type == "Journal") %>% 
  mutate(jr80 = if_else(is.na(jr80), 0, jr80),
         domain = factor(domain, levels = c("Arts & Humanities", "General", 
                                            "Applied Sciences", "Natural Sciences", 
                                              "Economic & Social Sciences", "Health Sciences")))

# Generate values for labeling
labvec <- download_jr80 %>% filter(provider == "Elsevier" & type == "Journal") %>% 
  group_by(domain) %>% 
  summarize(titles = n(),
            jr80 = sum(jr80, na.rm=T)) %>% 
  mutate(per = (jr80/titles)*100) %>% 
  arrange(per)

labvecper <- unlist(round(labvec[,4], 0))
labvecn <- unlist(labvec[,2] - labvec[,3])
labvecj <- unlist(labvec[,3])

# ploot
download_elsevier_jr80  %>% 
  ggplot(aes(x = domain, fill = as.factor(jr80))) + 
  geom_bar(stat = "count", position = "fill") +
  geom_hline(yintercept = 0.20) +
  scale_fill_manual(values = c("orange", "blue"),
                    labels=c("Top 80% Downloads", "Not Top 80% Downloads"),
                    breaks = rev(levels(as.factor(download_elsevier_jr80$jr80)))) +
  labs(title = "80% Use Titles by Domain",
        subtitle = "All Articles in Elsevier",
        y = "Percent", x = "Domain") +
  #annotate("text", label = paste0(labvecper, "%"), x = 1:6, y = (labvecper/100)+.05) +
  annotate("text", label = labvecj, x = 1:6, y = .04, color = "white") +
  annotate("text", label = labvecn, x = 1:6, y = .94, color = "white") +
  theme(legend.title=element_blank(), legend.position="bottom") +
  coord_flip()
```

* A slightly higher percent of journals in the Health Sciences domain makes it into the highly-used list (defined as journals accounting for 80% of 2017 downloads), at 24%. 22% percent of journls in the Economic & Social Sciences, 20% of journals in the Natural Sciences, and 20% of journals in the Applied sciences are among the most highly-used in the Elsevier. Among the small number of journals categorized as General, 17% are defined as highly-used by this metric, while only 6% of journals in the Arts & Humanities make the list.

## Percent of Journals Accounting for 90% of Use
The following repeats the above analysis, but moves the definition of high use to journals accounting for **90%** of downloads. This time, a 30% reference line is included for visual convenience.

```{r}
# ----------------------------------------------
# jr1 2017 downloads  
download_jr90 <- journal %>% 
  select(journal, provider, type, jr1, jr5, cites, pubs, synth, scopus, domain, field, jid) %>% 
  filter(type == "Journal") %>% 
  mutate(jr1 = as.integer(jr1)) %>% 
  arrange(provider, desc(jr1)) %>% 
  group_by(provider) %>% 
  mutate(cum_jr1 = cumsum(jr1),
         prov_jr1 = max(cum_jr1, na.rm=T),
         cum_jr1_per = (cum_jr1/prov_jr1)*100,
         jr90 = if_else(cum_jr1_per <= 90, 1, 0)) %>% 
  ungroup() 
```

```{r}
# Distribution of non-JR90 titles within Elsevier by domain
download_elsevier_jr90 <- download_jr90 %>% 
  filter(provider == "Elsevier" & type == "Journal") %>% 
  mutate(jr90 = if_else(is.na(jr90), 0, jr90),
         domain = factor(domain, levels = c("Arts & Humanities", "General", 
                                            "Applied Sciences", "Natural Sciences", 
                                            "Health Sciences", "Economic & Social Sciences")))

# Generate values for labeling
labvec <- download_jr90 %>% filter(provider == "Elsevier" & type == "Journal") %>% 
  group_by(domain) %>% 
  summarize(titles = n(),
            jr90 = sum(jr90, na.rm=T)) %>% 
  mutate(per = (jr90/titles)*100) %>% 
  arrange(per)

labvecper <- unlist(round(labvec[,4], 0))
labvecn <- unlist(labvec[,2] - labvec[,3])
labvecj <- unlist(labvec[,3])

# ploot
download_elsevier_jr90  %>% 
  ggplot(aes(x = domain, fill = as.factor(jr90))) + 
  geom_bar(stat = "count", position = "fill") +
   geom_hline(yintercept = 0.30) +
  scale_fill_manual(values = c("orange", "blue"),
                    labels=c("Top 90% Downloads", "Not Top 90% Downloads"),
                    breaks = rev(levels(as.factor(download_elsevier_jr90$jr90)))) +
  labs(title = "90% Use Titles by Domain",
       subtitle = "All Articles in Elsevier",
       y = "Percent", x = "Domain") +
  #annotate("text", label = paste0(labvecper, "%"), x = 1:6, y = (labvecper/100)+.05) +
  annotate("text", label = labvecj, x = 1:6, y = .04, color = "white") +
  annotate("text", label = labvecn, x = 1:6, y = .94, color = "white") +
  theme(legend.title=element_blank(), legend.position="bottom") +
  coord_flip()
```

* Journals in the Economic & Social Sciences and in the Health Sciences continue to dominate, with 35% and 34% of the titles included as high-use journals by the 90% metric, followed closely by the Natural Sciences (with 33% of journals categorized as high use) and the Applied Sciences (31%). 25% of General domain journals make the list, as do 14% of Arts & Humanities titles.
